# SharePoint CVE-2025 Attack Flows
Attack flows related to SharePoint vulnerabilities CVE-2025-53770/53771

<img width="1230" height="8000" alt="SharePoint CVE-2025-53770_53771 Global Campaign" src="https://github.com/user-attachments/assets/1f10d36d-dedf-4207-9060-e338d5c3bb9d" />

# SharePoint CVE-2025-53770/53771 Global Campaign Attack Flow

This directory contains a comprehensive STIX 2.1 attack flow model documenting the nation-state exploitation campaign affecting 400+ organizations worldwide through SharePoint Server vulnerabilities CVE-2025-53770 and CVE-2025-53771.

## Campaign Overview

**Timeline**: July 7-23, 2025  
**Attribution**: Unknown Advanced Threat Actor (suspected Linen Typhoon / Violet Typhoon)  
**Scale**: 400+ organizations compromised across 4 attack waves  
**Scope**: Global campaign targeting critical infrastructure  

## Vulnerability Details

| CVE | CVSS | Type | Description |
|-----|------|------|-------------|
| CVE-2025-53770 | 9.8 | Deserialization RCE | Remote code execution via ToolShell variant |
| CVE-2025-53771 | 6.5 | Path Traversal Spoofing | SharePoint spoofing vulnerability |

**Legacy Risk**: SharePoint 2010/2013 systems remain unpatched and vulnerable.

## Target Analysis

### Geographic Distribution
- **Primary**: United States
- **Secondary**: Western Europe, Canada, Brazil, Australia

### Sector Targeting
- **Government** (50%): DOE, DHS, Education, NIH, Nuclear Security Administration
- **Financial Services**: Major banking institutions
- **Business Services**: Corporate infrastructure
- **Telecommunications**: Critical communications infrastructure
- **Consumer Goods**: Supply chain targets

## Attack Flow Components

### Phase 1: Reconnaissance & Targeting
- Mass vulnerability scanning (T1595.002)
- Sector intelligence gathering (T1591.003)
- High-value target identification

### Phase 2: Initial Access
- CVE-2025-53770 exploitation chain
- CVE-2025-53771 path traversal abuse
- MFA/SSO bypass via SharePoint integration

### Phase 3: Execution & Persistence
- PowerShell execution (T1059.001): `w3wp.exe → cmd.exe → Base64-encoded PowerShell`
- Web shell deployment (T1505.003): `spinstall0.aspx` in `TEMPLATE\LAYOUTS\`
- Defense evasion through integration abuse

### Phase 4: Credential Access & Discovery
- Configuration file extraction (T1552.001)
- SharePoint farm enumeration (T1083)
- Microsoft 365 integration mapping (T1016)

### Phase 5: Lateral Movement & Collection
- SharePoint service account abuse (T1021.002)
- Microsoft 365 cloud access (T1580)
- Mass document collection (T1213.002)
- Email system access (T1114.002)

## Technical Indicators

### Network Indicators
```
107.191.58.76
104.238.159.149
96.9.125.147
139.144.199.41
```

### File Indicators
```
spinstall0.aspx (web shell)
debug_dev.js (supporting script)
```

### Process Indicators
```
w3wp.exe → cmd.exe → powershell.exe
Base64-encoded PowerShell execution
File creation in TEMPLATE\LAYOUTS\ directory
```

## Campaign Timeline

| Date | Event |
|------|-------|
| May 2025 | ToolShell demo at Pwn2Own Berlin |
| July 8 | Microsoft patches CVE-2025-49706/49704 |
| July 7 | Initial reconnaissance begins |
| July 17 | Wave 1 exploitation starts |
| July 18 | Eye Security observes global compromises |
| July 19 | Microsoft confirms CVE-2025-53770 zero-day |
| July 20 | Emergency patch released + CVE-2025-53771 disclosure |
| July 23 | 400+ systems compromised (4 waves completed) |

## Files in this Directory

- `sharepoint-cve-campaign-attack-flow.json` - Complete STIX 2.1 attack flow
- `sharepoint-cve-campaign-attack-flow.afb` - Attack Flow Builder format
- `campaign-timeline.md` - Detailed timeline analysis
- `iocs.json` - Machine-readable indicators of compromise

## Detection Strategies

### Immediate Actions Required
1. Apply emergency patches (July 20 update)
2. Isolate internet-facing SharePoint servers
3. Rotate all cryptographic material (ValidationKeys, DecryptionKeys)
4. Hunt for `spinstall0.aspx` web shells
5. Monitor `w3wp.exe` process execution chains
6. Decommission SharePoint 2010/2013 systems

### Detection Queries
- File creation monitoring in `TEMPLATE\LAYOUTS\`
- Process execution detection: `w3wp.exe` spawning `cmd.exe/powershell.exe`
- Base64 PowerShell execution pattern analysis
- Unusual SharePoint authentication pattern detection

## MITRE ATT&CK Mapping

**Tactics Covered**: Reconnaissance, Initial Access, Execution, Persistence, Defense Evasion, Credential Access, Discovery, Lateral Movement, Collection, Exfiltration

**Primary Techniques**:
- T1595.002 (Active Scanning)
- T1190 (Exploit Public-Facing Application)
- T1059.001 (PowerShell)
- T1505.003 (Web Shell)
- T1552.001 (Credentials in Files)
- T1021.002 (SMB/Windows Admin Shares)
- T1213.002 (SharePoint Data Collection)

## Intelligence Sources

- Microsoft Security Response Center (MSRC)
- Eye Security Global Threat Intelligence
- US-CERT Emergency Advisories
- Private sector threat intelligence feeds

---

This attack flow represents one of the most significant SharePoint exploitation campaigns documented, demonstrating the critical importance of timely patching and comprehensive monitoring of SharePoint infrastructure in enterprise environments.
